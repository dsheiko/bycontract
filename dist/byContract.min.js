!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("lib",[],r):"object"==typeof exports?exports.lib=r():t.lib=r()}("undefined"!=typeof self?self:this,(function(){return(()=>{"use strict";var t={862:function(t,r,e){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t}).apply(this,arguments)},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var i=a(e(775)),o=e(312),c=a(e(909));function s(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return i.default.options.enable?(t.map((function(t){return t.trim().replace(/[\r\n]/,"")})).filter((function(t){return t.length})).forEach((function(t,n){var a=o.parse(t).contract;if(!a||!(n in e))throw new r.Exception("EINVALIDJSODC","invalid JSDOC. Expected syntax::\n  @param {string|number} ${ foo }\n  @param {number} ${ bar }\n         ");try{r.validate(e[n],a)}catch(t){throw new r.Exception(t.code,"Argument #"+n+": "+t.message)}})),"ignore"):"ignore"}function u(t){return function(e,n,a){var c=a.value,s=o.validateJsDocString(t),u=s.params,f=s.returns;return i.default.options.enable?Object.assign({},a,{value:function(){var t=Array.from(arguments);u.forEach((function(e,a){try{r.validate(t[a],e.contract)}catch(t){throw new r.Exception(t.code,"Method: "+n+", parameter "+e.name+": "+t.message)}}));var e=c.apply(this,t);try{f&&r.validate(e,f.contract)}catch(t){throw new r.Exception(t.code,"Method: "+n+", return value: "+t.message)}return e}}):a}}r.validate=i.default.validate,r.Exception=i.default.Exception,r.typedef=i.default.typedef,r.config=i.default.config,r.validateCombo=i.default.validateCombo,r.is=i.default.is,r.validateContract=s,r.validateJsdoc=u,c.default.byContract=n(n({},i.default),{validateJsdoc:u,validateContract:s})},90:function(t,r){var e,n=this&&this.__extends||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(t,r)},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(r,"__esModule",{value:!0});var a=function(t){function r(e,n){var a=t.call(this,n)||this;return a.code=e,a.name="ByContractError",a.message=n,Object.setPrototypeOf(a,r.prototype),a}return n(r,t),r.prototype.toString=function(){return"ByContractError: "+this.message},r}(TypeError);r.default=a},775:function(t,r,e){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t}).apply(this,arguments)},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)Object.hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r.default=t,r};Object.defineProperty(r,"__esModule",{value:!0});var o=a(e(90)),c=i(e(900)),s=a(e(115));function u(t,r,e){return""+(r?r+": ":"")+(void 0!==e?"Argument #"+e+": ":"")+t}function f(t,r,e){if(!h.options.enable)return t;try{if(void 0===r)throw new o.default("EINVALIDPARAM",u("Invalid validate() parameters. The second parameter (contracts) is missing",e));if(s.default.array(r)&&!s.default.array(t)&&!s.default.arguments(t))throw new o.default("EINVALIDPARAM",u("Invalid validate() parameters. The second parameter (contracts) is array, the first one (values) expected to be array too",e));if(e&&!s.default.string(e))throw new o.default("EINVALIDPARAM",u("Invalid validate() parameters. The third parameter (callContext) shall be string or omitted",e));if(s.default.array(r)){if(s.default.arguments(t)&&(t=Array.from(t)),!s.default.array(t))throw new o.default("EINVALIDPARAM",u("Invalid parameters. When the second parameter (contracts) is an array, the first parameter (values) must an array too",e));return r.forEach((function(r,n){if(!(n in t)&&!r.match(/=$/))throw new o.default("EMISSINGARG",u("Missing required argument",e));l(t[n],r,e,n)})),t}l(t,r,e)}catch(t){throw t instanceof o.default&&Error.captureStackTrace&&Error.captureStackTrace(t,f),t}return t}function l(t,r,e,n){try{c.default(t,r)}catch(t){if(!(t instanceof o.default))throw t;throw new o.default(t.code,u(t.message,e,n))}}var h={options:{enable:!0},Exception:o.default,validate:f,typedef:function(t,r){if(f([t,r],["string","*"],"byContract.typedef"),t in s.default)throw new o.default("EINVALIDPARAM","Custom type must not override a primitive");c.customTypes[t]=r},config:function(t){h.options=n(n({},h.options),t)},validateCombo:function t(r,e,n){try{if(!s.default.array(r))throw new o.default("EINVALIDPARAM",u("Invalid validateCombo() parameters. The first parameter (values) shall be an array",n));if(!s.default.array(e))throw new o.default("EINVALIDPARAM",u("Invalid validateCombo() parameters. The second parameter (combo) shall be an array",n));var a=e.map((function(t){return function(t,r,e){try{return f(t,r,e),!1}catch(t){return t}}(r,t,n)}));if(a.every((function(t){return!1!==t})))throw a.find((function(t){return!1!==t}))}catch(r){throw r instanceof o.default&&Error.captureStackTrace&&Error.captureStackTrace(r,t),r}return r},is:s.default};r.default=h},115:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0});var e={arguments:function(t){return"[object Arguments]"===toString.call(t)},array:Array.isArray||function(t){return"[object Array]"===toString.call(t)},string:function(t){return"[object String]"===toString.call(t)},undefined:function(t){return void 0===t},boolean:function(t){return!0===t||!1===t||"[object Boolean]"===toString.call(t)},function:function(t){return"[object Function]"===toString.call(t)||"function"==typeof t},nan:function(t){return t!=t},null:function(t){return null===t},number:function(t){return!e.nan(t)&&"[object Number]"===toString.call(t)},regexp:function(t){return"[object RegExp]"===toString.call(t)},object:function(t){var r=typeof t;return"function"===r||"object"===r&&!!t}};r.default=e},312:function(t,r,e){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var a=n(e(90));function i(t){var r=t.indexOf("{"),e=t.indexOf("}");if(-1===r||-1===e)throw new a.default("EINVALIDJSDOC","invalid JSDOC. Expected syntax: { exp } param got "+t);return{contract:t.substr(r+1,e-r-1),name:t.substr(e+1).trim()}}r.parse=i,r.validateJsDocString=function(t){var r=[],e=null;return t.split("\n").map((function(t){return t.trim().replace(/\r/,"")})).filter((function(t){return t.length})).forEach((function(t){switch(!0){case t.startsWith("@param"):r.push(i(t));break;case t.startsWith("@returns"):e=i(t);break;default:throw new a.default("EINVALIDJSDOC","only @param and @returns tags allowed")}})),{params:r,returns:e}}},909:(t,r,e)=>{Object.defineProperty(r,"__esModule",{value:!0});var n="undefined"!=typeof window?window:e.g;r.default=n},900:function(t,r,e){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0});var a=n(e(90)),i=n(e(115)),o="undefined"!=typeof window?window:e.g;function c(t){return"object"==typeof t&&"constructor"in t&&t.constructor.name?"instance of "+t.constructor.name:"function"==typeof t?t.prototype.constructor.name:s(t)}function s(t){return Object.keys(i.default).find((function(r){return i.default[r](t)}))||typeof t}function u(t,r,e){void 0===e&&(e=""),new l(t,r,e).validate()}function f(t,r){return r?r+"."+t:t}r.customTypes={},r.default=u;var l=function(){function t(t,r,e){void 0===e&&(e=""),this.val=t,this.contract=r,this.propPath=e}return t.prototype.validate=function(){if(!this.assertAny()&&!this.assertObject()&&!this.assertInterface()){if(!i.default.string(this.contract))throw this.newException("EINVALIDCONTRACT","invalid parameters. Contract must be a string or a constructor function");if(!this.assertOptional()&&!this.assertBasicType()&&!this.assertNullable()){if(this.assertUnion())return!0;if(this.assertStrictArrayJson())return!0;if(!this.assertStrictArray()&&!this.assertStrictObject()&&!this.assertCustom()){if(!this.contract.match(/^[a-zA-Z0-9\._]+$/))throw this.newException("EINVALIDCONTRACT","invalid contract "+JSON.stringify(this.contract));if(!this.assertGlobal())throw this.newException("EINVALIDCONTRACT","invalid contract "+JSON.stringify(this.contract))}}}},t.prototype.assertCustom=function(){if(!(this.contract in r.customTypes))return!1;try{u(this.val,r.customTypes[this.contract])}catch(t){throw this.newException("EINVALIDTYPE","type "+this.contract+": "+t.message)}return!0},t.prototype.assertGlobal=function(){if(!(this.contract in o)||"function"!=typeof o[this.contract])return!1;if(this.val instanceof o[this.contract])return!0;throw this.newException("EINTERFACEVIOLATION","expected instance of "+o[this.contract]+" but got "+c(this.val))},t.prototype.assertAny=function(){return!(!i.default.string(this.contract)||"*"!==this.contract)},t.prototype.assertObject=function(){var t=this;if(!this.contract||"object"!=typeof this.contract)return!1;if(!this.val||"object"!=typeof this.val)throw this.newException("EINVALIDTYPE","expected object literal but got "+s(this.val));return Object.keys(this.contract).forEach((function(r,e){var n=t.contract[r];if(!(r in t.val)&&!function(t){return i.default.string(t)&&t.endsWith("=")}(n))throw t.newException("EMISSINGPROP","missing required property #"+f(r,t.propPath));u(t.val[r],n,f(r,t.propPath))})),!0},t.prototype.assertInterface=function(){if(!i.default.function(this.contract)&&"object"!=typeof this.contract)return!1;if(!(this.val instanceof this.contract))throw this.newException("EINTERFACEVIOLATION","expected instance of "+c(this.contract)+" but got "+c(this.val));return!0},t.prototype.assertOptional=function(){if(this.contract.match(/=$/)){if(!this.val)return!0;this.contract=this.contract.substr(0,this.contract.length-1)}return!1},t.prototype.assertBasicType=function(){var t=this.contract.toLowerCase(),r=i.default[t];if(void 0===r)return!1;if(!r(this.val))throw this.newException("EINVALIDTYPE","expected "+t+" but got "+s(this.val));return!0},t.prototype.assertNullable=function(){if(!this.contract.startsWith("?"))return!1;var t=this.contract.replace(/^\?/,"").toLowerCase(),r=i.default[t];if(i.default.null(this.val))return!0;if(void 0===r)throw this.newException("EINVALIDCONTRACT","invalid contract "+JSON.stringify(t));if(!r(this.val))throw this.newException("EINVALIDTYPE","expected "+this.contract+" but got "+s(this.val));return!0},t.prototype.assertUnion=function(){var t=this;if(!this.contract.includes("|"))return!1;var r=[];if(!this.contract.split("|").some((function(e){return function(t,r,e){void 0===e&&(e=[]);try{return u(t,r),!0}catch(t){if(!(t instanceof a.default))throw t;return e.push(t.message),!1}}(t.val,e,r)}))){var e=i.default.array(this.val)||i.default.object(this.val)?"failed on each: "+r.join(", "):"got "+s(this.val);throw this.newException("EINVALIDTYPE","expected "+this.contract+" but "+e)}return!0},t.prototype.assertStrictArrayJson=function(){if(!this.contract.endsWith("[]"))return!1;if(!i.default.array(this.val))return this.contract="array",this.assertBasicType();var t=this.contract.replace(/\[\]$/,""),r=0;if("*"===t)return this.contract="array",this.assertBasicType();try{i.default.array(this.val)&&this.val.forEach((function(e){u(e,t),r++}))}catch(t){throw this.newException("EINVALIDTYPE","array element "+r+": "+t.message)}return!0},t.prototype.assertStrictArray=function(){if(!this.contract.startsWith("Array.<"))return!1;if(!i.default.array(this.val))return this.contract="array",this.assertBasicType();var t=0,r=this.contract.match(/Array\.<(.+)>/i);if(!r)throw this.newException("EINVALIDCONTRACT","invalid contract "+c(this.contract));if("*"===r[1])return this.contract="array",this.assertBasicType();try{i.default.array(this.val)&&this.val.forEach((function(e){u(e,r[1]),t++}))}catch(r){throw this.newException("EINVALIDTYPE","array element "+t+": "+r.message)}return!0},t.prototype.assertStrictObject=function(){var t=this;if(0!==this.contract.indexOf("Object.<"))return!1;if(!i.default.object(this.val))return this.contract="object",this.assertBasicType();var r=null,e=this.contract.match(/Object\.<(.+),\s*(.+)>/i);if(!e)throw this.newException("EINVALIDCONTRACT","invalid contract "+c(this.contract));if("*"===e[2])return this.contract="object",this.assertBasicType();try{i.default.object(this.val)&&Object.keys(this.val).forEach((function(n){r=n,u(t.val[n],e[2])}))}catch(t){throw this.newException("EINVALIDTYPE","object property "+r+": "+t.message)}return!0},t.prototype.newException=function(t,r){var e=this.propPath?"property #"+this.propPath+" ":"";return new a.default(t,e+r)},t}()}},r={};function e(n){if(r[n])return r[n].exports;var a=r[n]={exports:{}};return t[n].call(a.exports,a,a.exports,e),a.exports}return e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e(862)})()}));